# ИДЗ №3 по АВС (на 9 баллов)
Омирбекова Дария, группа БПИ-217<br>
Вариант 34

# Используемые файлы:
- До модификации:
> главный файл с функцией main - [main.c](), [main.s]()<br>
побочный файл с функцией task для вычисления корня уравнения - [task.c](), [task.s]()<br>
- После модификации:
> главный файл с функцией main - [main.c](), [main.s]()<br>
побочный файл с функцией task для вычисления корня уравнения - [task.c](), [task.s]()<br>

# <a name="explanation">Пояснения к запуску и эксплуатации:</a>
Чтобы запустить программу необходимо с необходимым режимом следует ввести следующие команды:<br>
- С использованием аргументов командной строки:

Если нужно работать с вводом с консоли:
```s
./program.exe epsilon
# где epsilon - константа, определяющая точность вычисления корня
# константу необхожимо выбрать из диапазона [0.001, 0.00000001] и обязательно использовать для ввода точку
```
Если нужно работать с вводом с файла:
```s
./program.exe input.txt output.txt
# где input.txt - это название файла, с которого нужно считать информацию
# где output.txt - это название файла, в который нужно записать информацию
```
Если нужно работать с рандомно сгенерированной точностью вычисления:
```s
./program.exe
```
# На 4 балла:
### - Приведено решение задачи на C.
> главный файл с функцией main (после модификации) - [main.c]()<br>
побочный файл с функцией task для вычисления корня уравнения (после модификации) - [task.c]()<br>

### - В полученную ассемблерную программу, откомпилированную без оптимизирующих и отладочных опций, добавлены комментарии, поясняющие эквивалентное представление переменных в программе на C.
> главный файл с функцией main (после модификации) - [main.s]()<br>
побочный файл с функцией task для вычисления корня уравнения (после модификации) - [task.s]()<br>

### - Из ассемблерной программы убраны лишние макросы за счет использования соответствующих аргументов командной строки:
> главный файл с функцией main (после модификации) - [main.s]()<br>
побочный файл с функцией task для проверки строки на палиндром (после модификации) - [task.s]()<br>

Убраны следующие строчки кода в файле main.s:<br>
```s
	endbr64                                                           
```
Убраны следующие строчки кода в файле task.s:<br>
```s
	endbr64				     	  
```

### - Модифицированная ассемблерная программа отдельно откомпилирована и скомпонована без использования опций отладки.
Скомпоновала программу, с помощью команд:
```s
gcc -masm=intel -fno-asynchronous-unwind-tables -fno-jump-tables -fno-stack-protector -fno-exceptions -fverbose-asm ./main.c -S -o ./main.s
gcc -masm=intel -fno-asynchronous-unwind-tables -fno-jump-tables -fno-stack-protector -fno-exceptions -fverbose-asm ./task.c -S -o ./task.s
gcc ./main.s -c -o main.o
gcc ./task.s -c -o task.o
gcc ./task.o main.o -o program.exe
```

### - Представлено полное тестовое покрытие, дающее одинаковый результат на обоих программах.
Программы были протестированы на следующих тестовых данных:
```
0.1
0.001
0.00000001
0.00034
0.0000099
```
- Все тесты обе программы выполнили успешно, выдав одинаковый результат:
1. ![image](https://user-images.githubusercontent.com/111382627/203544049-7338f091-d50b-477e-bef9-7329658ed1df.png)
2. ![image](https://user-images.githubusercontent.com/111382627/203544174-ba13f72f-f466-4c32-a530-3ea74e5eeaa5.png)
3. ![image](https://user-images.githubusercontent.com/111382627/203544260-8f1827c7-bfaa-469c-bfda-403c443c9959.png)
4. ![image](https://user-images.githubusercontent.com/111382627/203544389-fa1fad3a-f104-4247-8d5f-b67ee5e8da12.png)
5. ![image](https://user-images.githubusercontent.com/111382627/203544486-66c0bb4f-1aaa-4ac6-bb4e-e97cb7eacfad.png)

# На 5 баллов:
### - В реализованной программе использовать функции с передачей данных через параметры.
> файл с функцией task - [task.c]()<br>

Для реализации данного пункта использовалась отдельные функции Task(const double e) и function(double x):
```c
double function(double x)
double Task(const double e)

```

### - Использовать локальные переменные.
> главный файл с функцией main - [main.c]()<br>
побочный файл с функцией task - [task.c]()<br>

Локальные переменные, которые были использованы в функции main:
```c
int i;
double epsilon;
char* temp;
time_t t_start;
time_t t_end;
FILE *input_stream;
FILE *output_stream;
```
Локальные переменные, которые были использованы в функции task:
```c
double x;
double e;
double a;
double b;
double c;
double eps;
```
### - В ассемблерную программу при вызове функции добавить комментарии, описывающие передачу фактических параметров и перенос возвращаемого результата.
> главный файл с функцией main - [main.s]()<br>
побочный файл с функцией task - [task.s]()<br>

### - В функциях для формальных параметров добавить комментарии, описывающие связь между параметрами языка Си и регистрами (стеком).
> главный файл с функцией main - [main.s]()<br>
побочный файл с функцией task - [task.s]()<br>

# На 6 баллов:
### - Рефакторинг программы на ассемблере за счет максимального использования регистров процессора.
Все локальные переменные заменены на регистры. Добавлены соответствующие комментарии в коде программ.<br>
> В файле с функцией main - [main.s]():<br>
```
# r13d - i (16-ой строки в СИ)
# r14d - i (36-ой строки в СИ)
# rbp-32 - input_stream
# rbp-40 - output_stream
# rbp-48 - t_start
# rbp-56 - t_end
# rbp-60 - answer
# r15d - length
# rbp-320 - str
# rbp-576 - arr_str
# rbp-580 - argc
# rbp-592 - argv
```
> В файле с функцией task - [task.s](https://github.com/Raaazzy/Home_work_2/blob/main/%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8/task.s):<br>
```
# r14d - i (Task)
# r13d - set_len
# rbp-24 - str (Task)
# rbp-256 - str (Task_file)
# rbp-272 - str (Task_random)
# r15d - length
```

### - Добавление комментариев в разработанную программу, поясняющих эквивалентное использование регистров вместо переменных исходной программы на C.
> главный файл с функцией main - [main.s](https://github.com/Raaazzy/Home_work_2/blob/main/%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8/main.s)<br>
побочный файл с функцией task - [task.s](https://github.com/Raaazzy/Home_work_2/blob/main/%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%20%D0%BC%D0%BE%D0%B4%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8/task.s)<br>

### - Представлены тестовые прогоны для разработанной программы.
Программа была протестирована на следующих тестовых данных:
```
a
1
abccba
abcba
qwe
asdfg
```
- Все тесты программа выполнила успешно, выдав корректный результат:
1. ![image](https://user-images.githubusercontent.com/111382627/201492245-eff00004-f7dd-4b5e-b7b9-d160776fd10e.png)
2. ![image](https://user-images.githubusercontent.com/111382627/201492259-0ec720b1-db87-445b-8c16-c6fa0892c642.png)
3. ![image](https://user-images.githubusercontent.com/111382627/201492272-dbeb6ea0-ad8d-424e-8752-542b471fe8ca.png)
4. ![image](https://user-images.githubusercontent.com/111382627/201492289-89ff0a28-1b64-4399-af75-cafe23883646.png)
5. ![image](https://user-images.githubusercontent.com/111382627/201492311-4b0f9b30-fc17-467e-a2fd-72571cd488c0.png)
6. ![image](https://user-images.githubusercontent.com/111382627/201492325-efeb5e34-0ba0-4e1c-9b22-94d3e4ac90e6.png)

### - Сопоставим размеры программы до модификации и после:
- В модифицированной программе содержится приблизительно 415 строк кода без учета комментариев. При этом ее вес составляет 14 KiB.<br>
- В не модифицированной программе содержиться приблизительно 475 строк кода без учета комментариев. При этом ее вес составляет 15 KiB.<br>


